<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owl Carousel Controlado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.theme.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            /* height: 100vh; */
        }

        .item {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;


        }

        .iframe {
            width: 100%;
            height: 100%;
        }

        .square {
            width: 20%;
            height: 100px;
            border: 1px solid #424242;
            background-color: #1e1e1e;
            margin: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            border-radius: 8px;
            transition: transform 0.2s, background-color 0.2s;
        }

        .square:hover {
            transform: scale(1.05);
            background-color: #2c2c2c;
        }

        .title {
            position: absolute;
            top: 5px;
            font-size: 0.8rem;
            color: #9e9e9e;
        }

        .count {
            font-size: 1.5rem;
            margin-top: 10px;
            color: #e0e0e0;
        }

        .key {
            font-size: 1rem;
            margin-top: 5px;
            color: #bdbdbd;
        }

        .tituloCategoria {
            width: 100%;
            text-align: center;
        }
    </style>
</head>

<body>

    <div id="owl-carousel" class="owl-carousel owl-theme">
        <div id="um" class="item"></div>
        <div id="dois" class="item">Div 2</div>
        <div id="tres" class="item">Div 3</div>
        <div id="quatro" class="item">Div 4</div>
        <div id="cinco" class="item">Div 5</div>
        <div id="seis" class="item">Div 6</div>
        <div id="sete" class="item">Div 7</div>
        <div id="oito" class="item">Div 8</div>
        <div id="nove" class="item">Div 9</div>
        <div id="dez" class="item">Div 10</div>
        <div id="onze" class="item" data-multi="1">
            <input type="text" class="search-box" placeholder="Buscar Cidade, Bairro ou Estado...">
            <div class="container">
                <div class="section" id="cities">
                    <h2>Cidades</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Quantidade</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="section" id="neighborhoods">
                    <h2>Bairros</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Quantidade</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="section" id="states">
                    <h2>Estados</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Quantidade</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <script>
                const data = {
                    cities: [
                        'Abaetetuba', 'Abel Figueiredo', 'Acara', 'Afua', 'Agua Azul do Norte', 'Alenquer', 'Almeirim', 'Altamira',
                        'Anajas', 'Ananindeua', 'Anapu', 'Augusto Correa', 'Aurora do Para', 'Aveiro', 'Bagre', 'Baiao', 'Bannach',
                        'Barcarena', 'Belem', 'Belterra', 'Benevides', 'Bom Jesus do Tocantins', 'Bonito', 'Braganca', 'Brasil Novo',
                        'Brejo Grande do Araguaia', 'Breu Branco', 'Breves', 'Bujaru', 'Cachoeira do Arari', 'Cachoeira do Piria',
                        'Cameta', 'Canaa dos Carajas', 'Capanema', 'Capitao Poco', 'Castanhal', 'Chaves', 'Colares', 'Conceicao do Araguaia',
                        'Concordia do Para', 'Cumaru do Norte', 'Curionopolis', 'Curralinho', 'Curua', 'Curuca', 'Dom Eliseu', 'Eldorado do Carajas',
                        'Faro', 'Floresta do Araguaia', 'Garrafao do Norte', 'Goianesia do Para', 'Gurupa', 'Igarape-Acu', 'Igarape-Miri',
                        'Inhangapi', 'Ipixuna do Para', 'Irituia', 'Itaituba', 'Itupiranga', 'Jacareacanga', 'Jacunda', 'Juruti', 'Limoeiro do Ajuru',
                        'Mae do Rio', 'Magalhaes Barata', 'Maraba', 'Maracana', 'Marapanim', 'Marituba', 'Medicilandia', 'Melgaco', 'Mocajuba', 'Moju',
                        'Monte Alegre', 'Muana', 'Nova Esperanca do Piria', 'Nova Ipixuna', 'Nova Timboteua', 'Novo Progresso', 'Novo Repartimento',
                        'Obidos', 'Oeiras do Para', 'Oriximina', 'Ourem', 'Ourilandia do Norte', 'Pacaja', 'Palestina do Para', 'Paragominas',
                        'Parauapebas', 'Pau Darco', 'Peixe-Boi', 'Picarra', 'Placas', 'Ponta de Pedras', 'Portel', 'Porto de Moz', 'Prainha',
                        'Primavera', 'Quatipuru', 'Redencao', 'Rio Maria', 'Rondon do Para', 'Ruropolis', 'Salinopolis', 'Salvaterra',
                        'Santa Barbara do Para', 'Santa Cruz do Arari', 'Santa Isabel do Para', 'Santa Luzia do Para', 'Santa Maria das Barreiras',
                        'Santa Maria do Para', 'Santarem', 'Santarem Novo', 'Santo Antonio do Taua', 'Sao Caetano de Odivelas', 'Sao Domingos do Araguaia',
                        'Sao Domingos do Capim', 'Sao Felix do Xingu', 'Sao Francisco do Para', 'Sao Geraldo do Araguaia', 'Sao Joao da Ponta',
                        'Sao Joao de Pirabas', 'Sao Joao do Araguaia', 'Sao Miguel do Guama', 'Sao Sebastiao da Boa Vista', 'Sapucaia', 'Senador Jose Porfirio',
                        'Soure', 'Tailândia', 'Terra Alta', 'Terra Santa', 'Tome-Acu', 'Tracuateua', 'Trairao', 'Tucuma', 'Tucurui', 'Ulianopolis',
                        'Urucara', 'Vigia', 'Viseu', 'Vitoria do Xingu', 'Xinguara'
                    ],
                    neighborhoods: [
                        'Agrovila Calucia', 'Agrovila 3 de outubro', 'Agrovila Bacabal', 'Agrovila Bacuri', 'Agrovila Boa Vista',
                        'Agrovila C. Branco', 'Agrovila Cupiuba', 'Agrovila Iracema', 'Agrovila Itaqui', 'Agrovila João Batista',
                        'Agrovila Macapazinho', 'Agrovila Nazare', 'Agrovila Pacuquara', 'Agrovila S. Terezinha', 'Agrovila S. Raimundo',
                        'Ana Júlia', 'Bairro Novo', 'Betânia', 'Bom Jesus', 'Caiçara', 'Camp. Elisios', 'Camp. Lindos', 'Cariri',
                        'Centro', 'Conj. Tangaras', 'Conj. Ypês', 'Cristo', 'Estrela', 'Florestal', 'Fonte Boa', 'Heliolandia', 'Ianetama',
                        'Imperador', 'Imperial', 'Jaderlândia', 'Jardim Acacias', 'Jardim Castanhal', 'Jardim Modelo', 'Jardim Tropical',
                        'Milagre/Sta. Lidia', 'Nova Olinda', 'Novo Caiçara', 'Novo Estrela', 'Novo Horizonte', 'Pantanal', 'Prq. Castanhais',
                        'Prq. dos Buritis', 'Pirapora', 'Propira', 'Rouxinol', 'Salgadinho', 'Sta Catarina', 'Santa Helena', 'Sta Terezinha',
                        'São José', 'Saudade', 'Saudade II', 'Titanlândia', 'Tókio', 'Vila do Apeú', 'Zona Rural', 'Não Identif.'
                    ],
                    states: [
                        'Acre', 'Alagoas', 'Amapá', 'Amazonas', 'Bahia', 'Ceará', 'Distrito Federal', 'Espírito Santo', 'Goiás', 'Maranhão',
                        'Mato Grosso', 'Mato Grosso do Sul', 'Minas Gerais', 'Pará', 'Paraíba', 'Paraná', 'Pernambuco', 'Piauí',
                        'Rio de Janeiro', 'Rio Grande do Norte', 'Rio Grande do Sul', 'Rondônia', 'Roraima', 'Santa Catarina', 'São Paulo',
                        'Sergipe', 'Tocantins'
                    ]
                };

                document.addEventListener('DOMContentLoaded', () => {
                    const searchBox = document.querySelector('.search-box');

                    searchBox.addEventListener('input', function () {
                        updateSuggestions(this);
                    });

                    searchBox.addEventListener('keydown', function (e) {
                        if (e.key === 'Enter') {
                            incrementCount(this.value);
                            this.value = '';
                            clearSuggestions();
                            this.blur();
                            
                        }
                    });
                });

                function normalizeText(text) {
                    return text.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                }

                function updateSuggestions(input) {
                    const allData = [
                        ...data.cities.map(city => ({ name: city, category: 'Cidade' })),
                        ...data.neighborhoods.map(neighborhood => ({ name: neighborhood, category: 'Bairro' })),
                        ...data.states.map(state => ({ name: state, category: 'Estado' }))
                    ];
                    const searchText = normalizeText(input.value);
                    const suggestions = allData.filter(item => normalizeText(item.name).includes(searchText));
                    const datalist = document.createElement('datalist');
                    datalist.id = `datalist-suggestions`;
                    clearSuggestions();
                    suggestions.forEach(item => {
                        const option = document.createElement('option');
                        option.value = `${item.name} (${item.category})`;
                        datalist.appendChild(option);
                    });
                    document.body.appendChild(datalist);
                    input.setAttribute('list', datalist.id);
                }

                function clearSuggestions() {
                    document.querySelectorAll('datalist').forEach(datalist => datalist.remove());
                }

                function incrementCount(selectedText) {
                    const name = selectedText.replace(/\s+\(.*?\)$/, ''); // Remove the category from the selected text
                    let category;
                    if (data.cities.includes(name)) {
                        category = 'cities';
                    } else if (data.neighborhoods.includes(name)) {
                        category = 'neighborhoods';
                    } else if (data.states.includes(name)) {
                        category = 'states';
                    }

                    if (category) {
                        const tableBody = document.querySelector(`#${category} tbody`);
                        let row = [...tableBody.rows].find(row => row.cells[0].textContent === name);

                        if (row) {
                            row.cells[1].textContent = parseInt(row.cells[1].textContent) + 1;
                        } else {
                            row = tableBody.insertRow();
                            const cellName = row.insertCell(0);
                            const cellCount = row.insertCell(1);
                            cellName.textContent = name;
                            cellCount.textContent = 1;
                        }

                        sortTable(tableBody);
                    }
                }

                function sortTable(tableBody) {
                    const rows = Array.from(tableBody.rows);
                    rows.sort((a, b) => a.cells[0].textContent.localeCompare(b.cells[0].textContent));

                    rows.forEach(row => tableBody.appendChild(row));
                }


            </script>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.js"></script>
    <script>
        const letras = {
            1: "A",
            2: "S",
            3: "D",
            4: "F",
            5: "G",
            6: "H",
            7: "J",
            8: "K",
            9: "L",
            10: "Ç",
            11: "Z",
            12: "X",
            13: "C",
            14: "V",
            15: "B"
        };
        var dados = {
            "Dados Pessoais": {
                "NumeroRegistro": "",
                "CidadeBairro": ""
            },
            "FaixaEtaria": {
                "0a13": 0,
                "14a21": 0,
                "22a59": 0,
                "60ouMais": 0
            },
            "Sexo": {
                "Feminino": 0,
                "Masculino": 0
            },
            "CartaoSUS": {
                "ComCartao": 0,
                "SemCartao": 0
            },
            "ClassificacaoRisco": {
                "Classificado": 0,
                "NaoClassificado": 0
            },
            "Anamnese": {
                "PA": 0,
                "PulsoFC": 0,
                "FR": 0,
                "Saturacao": 0,
                "Temperatura": 0,
                "Peso": 0,
                "Glicemia": 0,
                "Inalacao": 0
            },
            "Consultas": {
                "Medico": 0,
                "Enfermeiro": 0,
                "AssistenteSocial": 0
            },
            "AcidentesTransito": {
                "MOTO_X_CARRO": 0,
                "MOTO_X_MOTO": 0,
                "MOTO_X_VEICULO_GRANDE": 0,
                "MOTO_QUEDA": 0,
                "MOTO_OUTROS": 0,
                "VEICULO_GRANDE": 0,
                "CARRO_CAPOTAMENTO": 0,
                "CARRO_X_CARRO": 0,
                "CARRO_X_VEICULO_GRANDE": 0,
                "CARRO_OUTROS": 0,
                "ATROPELAMENTO": 0,
                "BICICLETA": 0
            },
            "CausasAcidente": {
                "FAB": 0,
                "FAF": 0,
                "ACIDENTE_TRABALHO": 0,
                "GESTANTE": 0,
                "AGRESSAO_FISICA": 0,
                "TRAUMA": 3
            },
            "Quedas": {
                "PROP_ALTURA": 0,
                "+1m": 0,
                "CAMA": 0,
                "ESCADA": 0,
                "CAVALO": 0,
                "QUEDA_ARVORE": 0,
                "REDE": 0,
                "TELHADO": 0,
                "OUTROS": 0,
                "TENTATIVA_SUICIDIO": 0
            }
        };
        $(document).ready(function () {


            // Função para percorrer e exibir dados de cada categoria
            function exibirDados(categoria, titulo) {
                //console.log(`\n**${titulo}**`);
                for (const chave in categoria) {
                    //console.log(`${chave}: ${categoria[chave]}`);
                }
            }

            function populaDados(div, categoria, multi) {
                //se multi = 1 o trigger nao passa automaticamente, se for 0 passa automaticamente
                const elem = document.getElementById(div);
                elem.innerHTML = "<h2 class='tituloCategoria'>" + categoria + "</h2>";
                categoria = dados[categoria];
                const fragment = document.createDocumentFragment();
                let i = 1;
                for (const chave in categoria) {
                    const square = document.createElement('div');
                    square.classList.add('square');

                    const title = document.createElement('div');
                    title.classList.add('title');
                    title.textContent = chave;

                    const count = document.createElement('div');
                    count.classList.add('count');
                    count.dataset.key = letras[i]; // Set data-key to the actual key
                    count.dataset.multi = multi;
                    count.textContent = categoria[chave]; // Update count based on categoria data

                    const key = document.createElement('div');
                    key.classList.add('key');
                    key.textContent = letras[i];

                    square.appendChild(title);
                    square.appendChild(count);
                    square.appendChild(key);

                    fragment.appendChild(square);
                    i++;
                } //fim loop

                elem.appendChild(fragment);
            }


            populaDados("um", "Dados Pessoais", "n");
            populaDados("dois", "FaixaEtaria", "n");
            populaDados("tres", "Sexo", "n");
            populaDados("quatro", "CartaoSUS", "n");
            populaDados("cinco", "ClassificacaoRisco", "n");
            populaDados("seis", "AcidentesTransito", "n");
            populaDados("sete", "CausasAcidente", "n");
            populaDados("oito", "Quedas", "n");
            populaDados("nove", "Anamnese", "s");
            populaDados("dez", "Consultas", "s");



            // Exibir dados de cada categoria
            exibirDados(dados["Dados Pessoais"], "Dados Pessoais");
            exibirDados(dados["FaixaEtaria"], "Faixa Etária");
            exibirDados(dados["Sexo"], "Sexo");
            // ... (adicione outras categorias aqui)



            // Exemplo de como acessar um valor específico
            const numeroAcidentesMotoQueda = dados["AcidentesTransito"]["MOTO_QUEDA"];
            console.log(`Número de acidentes de moto com queda: ${numeroAcidentesMotoQueda}`);
            var owl = $("#owl-carousel").owlCarousel({
                items: 1,
                loop: true,
                nav: false,
                dots: false,
                autoPlay: false
            });

            function updateActiveClass() {
                $('.owl-item').removeClass('active');
                var currentIndex = owl.data('owlCarousel').currentItem;
                $('.owl-item').eq(currentIndex).addClass('active');
            }
            function proximo() {
                owl.trigger('owl.next');
                updateActiveClass();
            }

            owl.on('changed.owl.carousel', updateActiveClass);
            updateActiveClass(); // Initial call

            $(document, ".iframe").keydown(function (event) {
                var key = event.key.toUpperCase();
                var activeItem = $(".owl-item.active .item");

                if (key === 'ENTER') {
                    proximo();
                } else if (event.key === 'ArrowLeft') {
                    owl.trigger('owl.prev');
                    updateActiveClass();
                } else {
                    activeItem.find('.count').each(function () {
                        if ($(this).data('key') === key) {
                            var count = parseInt($(this).text());
                            if (event.shiftKey) {
                                count = count > 0 ? count - 1 : 0;
                            } else {
                                count++;
                            }
                            $(this).text(count);
                            if ($(this).data('multi') == "n") {

                                proximo();
                            }
                        }

                    });
                }
            });
        });
    </script>

</body>

</html>